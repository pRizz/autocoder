---
phase: 07-ts-bun-solid-parity-matrix-and-discrepancies
plan: 03
type: execute
wave: 2
depends_on: ["07-01"]
files_modified:
  - .planning/specs/parity/INTENDED-VS-OBSERVED-DISCREPANCY-LEDGER.md
autonomous: true
requirements: ["MIGR-03", "MIGR-04"]
user_setup: []
must_haves:
  truths:
    - "An intended-vs-observed discrepancy ledger exists with explicit decisions for behavior areas where implementation details differ from desired parity intent."
    - "Discrepancy entries make external-surface impact explicit and prevent silent behavior drift in migration planning."
  artifacts:
    - ".planning/specs/parity/INTENDED-VS-OBSERVED-DISCREPANCY-LEDGER.md"
  key_links:
    - "INTENDED-VS-OBSERVED-DISCREPANCY-LEDGER.md links each discrepancy entry to parity matrix ART references and relevant surface contracts."
---

<objective>
Create the intended-vs-observed discrepancy ledger for migration planning.

Purpose: Satisfy MIGR-03 and reinforce MIGR-04 by explicitly recording where behavior intent and observed implementation diverge.
Output: Structured discrepancy ledger with explicit disposition decisions.
</objective>

<execution_context>
@/Users/peterryszkiewicz/.claude/get-shit-done/workflows/execute-plan.md
@/Users/peterryszkiewicz/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/REQUIREMENTS.md
@.planning/specs/parity/TS-BUN-SOLID-PARITY-MATRIX.md
@.planning/specs/surfaces/REST-API-CONTRACTS.md
@.planning/specs/surfaces/WEBSOCKET-CONTRACTS.md
@.planning/specs/surfaces/DATA-PERSISTENCE-CONTRACTS.md
@.planning/specs/surfaces/PROCESS-LIFECYCLE-CONTRACTS.md
@.planning/specs/surfaces/SECURITY-POLICY-CONTRACTS.md
@.planning/specs/surfaces/SURFACE-CROSS-CONTRACT-CONSISTENCY.md
@.planning/phases/07-ts-bun-solid-parity-matrix-and-discrepancies/07-RESEARCH.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Build discrepancy inventory with deterministic IDs</name>
  <files>.planning/specs/parity/INTENDED-VS-OBSERVED-DISCREPANCY-LEDGER.md</files>
  <action>Create discrepancy ledger with exactly `16` entries (`Q01`..`Q16`) spanning backend/runtime, frontend/UI, non-TS ops assets, and cross-surface policy/lifecycle concerns. Include columns for discrepancy ID, related ART IDs, intended behavior, observed behavior, and migration disposition (`preserve`, `clarify`, `defer-with-guardrail`).</action>
  <verify>test -f .planning/specs/parity/INTENDED-VS-OBSERVED-DISCREPANCY-LEDGER.md && test "$(rg -n '^\| Q[0-9]{2} \|' .planning/specs/parity/INTENDED-VS-OBSERVED-DISCREPANCY-LEDGER.md | wc -l | tr -d ' ')" = "16"</verify>
  <done>Discrepancy ledger exists with deterministic inventory and dispositions.</done>
</task>

<task type="auto">
  <name>Task 2: Link discrepancy entries to parity and surface anchors</name>
  <files>.planning/specs/parity/INTENDED-VS-OBSERVED-DISCREPANCY-LEDGER.md</files>
  <action>For each discrepancy, include explicit links to affected parity matrix rows and relevant surface contract anchors (REST/WebSocket/Data/Process/Security). Add external-surface impact notes indicating whether externally observable behavior is preserved 1:1.</action>
  <verify>rg -n "TS-BUN-SOLID-PARITY-MATRIX|REST-API-CONTRACTS|WEBSOCKET-CONTRACTS|DATA-PERSISTENCE-CONTRACTS|PROCESS-LIFECYCLE-CONTRACTS|SECURITY-POLICY-CONTRACTS|external surface|1:1" .planning/specs/parity/INTENDED-VS-OBSERVED-DISCREPANCY-LEDGER.md</verify>
  <done>Discrepancy entries are fully traceable to parity and surface contracts.</done>
</task>

<task type="auto">
  <name>Task 3: Add MIGR-03/MIGR-04 acceptance checks</name>
  <files>.planning/specs/parity/INTENDED-VS-OBSERVED-DISCREPANCY-LEDGER.md</files>
  <action>Add `Acceptance Checks` with objective pass/fail criteria for discrepancy count (`16/16`), mandatory disposition field coverage, and explicit external-surface impact statements.</action>
  <verify>rg -n "Acceptance Checks|MIGR-03|MIGR-04|16/16|disposition|external surface|pass/fail" .planning/specs/parity/INTENDED-VS-OBSERVED-DISCREPANCY-LEDGER.md</verify>
  <done>Discrepancy ledger includes executable MIGR-03/MIGR-04 gates.</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] test -f .planning/specs/parity/INTENDED-VS-OBSERVED-DISCREPANCY-LEDGER.md
- [ ] test "$(rg -n '^\| Q[0-9]{2} \|' .planning/specs/parity/INTENDED-VS-OBSERVED-DISCREPANCY-LEDGER.md | wc -l | tr -d ' ')" = "16"
- [ ] rg -n "MIGR-03|MIGR-04|Acceptance Checks|external surface|16/16" .planning/specs/parity/INTENDED-VS-OBSERVED-DISCREPANCY-LEDGER.md
- [ ] git diff --name-only | rg -v '^\.planning/' returns no output
</verification>

<success_criteria>

- All tasks completed
- Discrepancy corpus objectively records intended-vs-observed deltas
- External-surface impact is explicit per discrepancy
- No source implementation files modified

</success_criteria>

<output>
After completion, create `.planning/phases/07-ts-bun-solid-parity-matrix-and-discrepancies/07-03-SUMMARY.md`
</output>
