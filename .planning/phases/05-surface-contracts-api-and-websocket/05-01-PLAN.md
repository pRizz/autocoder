---
phase: 05-surface-contracts-api-and-websocket
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - .planning/specs/surfaces/REST-API-ENDPOINT-MATRIX.md
  - .planning/specs/surfaces/REST-API-CONTRACTS.md
autonomous: true
requirements: ["SURF-01"]
user_setup: []
must_haves:
  truths:
    - "REST/API contract corpus includes every mounted HTTP API endpoint with method/path coverage and implementing artifact linkage."
    - "REST/API contracts capture payload schemas, status codes, and error behavior sufficient for regeneration and compatibility checks."
  artifacts:
    - ".planning/specs/surfaces/REST-API-ENDPOINT-MATRIX.md"
    - ".planning/specs/surfaces/REST-API-CONTRACTS.md"
  key_links:
    - "REST-API-CONTRACTS.md references REST-API-ENDPOINT-MATRIX.md as canonical completeness source."
---

<objective>
Document the complete REST/API surface as authoritative contracts.

Purpose: Satisfy SURF-01 by capturing all mounted HTTP endpoints with payload, status, and error semantics.
Output: REST endpoint inventory matrix plus detailed API contract specification.
</objective>

<execution_context>
@/Users/peterryszkiewicz/.claude/get-shit-done/workflows/execute-plan.md
@/Users/peterryszkiewicz/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/REQUIREMENTS.md
@.planning/specs/INDEX.md
@.planning/specs/INVENTORY.md
@.planning/specs/contracts/FILE-CONTRACT-COVERAGE.md
@.planning/specs/contracts/backend-runtime/
@server/main.py
@server/routers/
@server/schemas.py
@ui/src/lib/api.ts
@.planning/phases/05-surface-contracts-api-and-websocket/05-RESEARCH.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Build canonical REST endpoint inventory matrix</name>
  <files>.planning/specs/surfaces/REST-API-ENDPOINT-MATRIX.md</files>
  <action>Create endpoint matrix listing every mounted HTTP API route from `server/routers/*.py` plus `/api/health` and `/api/setup/status` from `server/main.py`. Include columns: method, path, router/module ART ID, request schema, response schema, status-code set, and contract status. Expected total: 68 routes.</action>
  <verify>test -f .planning/specs/surfaces/REST-API-ENDPOINT-MATRIX.md && test "$(rg -n '^\\| (GET|POST|PUT|PATCH|DELETE) \\|' .planning/specs/surfaces/REST-API-ENDPOINT-MATRIX.md | wc -l | tr -d ' ')" = "68"</verify>
  <done>REST matrix exists with complete method/path inventory and implementation/schema linkage for all API routes.</done>
</task>

<task type="auto">
  <name>Task 2: Author REST/API contract specification</name>
  <files>.planning/specs/surfaces/REST-API-CONTRACTS.md</files>
  <action>Author detailed REST contract doc organized by domain (projects, features, agent, schedules, devserver, filesystem, settings, assistant/spec/expand session control, terminal control, health/setup). For each endpoint contract include purpose, request shape, response shape, status codes, and error behavior with references to schema/model artifacts where applicable.</action>
  <verify>rg -n \"Projects|Features|Agent|Schedules|DevServer|Filesystem|Settings|Assistant|Spec|Expand|Terminal|Health|Setup|Status Codes|Error Behavior\" .planning/specs/surfaces/REST-API-CONTRACTS.md</verify>
  <done>REST contract document defines request/response/status/error semantics for every endpoint in matrix scope.</done>
</task>

<task type="auto">
  <name>Task 3: Validate REST completeness and acceptance checks</name>
  <files>.planning/specs/surfaces/REST-API-CONTRACTS.md</files>
  <action>Add explicit acceptance checks proving matrix-to-contract completeness (68/68), route-level status/error coverage, and schema linkage quality. Include pass/fail criteria for future verification agents.</action>
  <verify>rg -n \"Acceptance Checks|68/68|matrix-to-contract|status codes|error behavior|pass/fail\" .planning/specs/surfaces/REST-API-CONTRACTS.md</verify>
  <done>REST contract doc includes executable acceptance checks for SURF-01 verification.</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] test -f .planning/specs/surfaces/REST-API-ENDPOINT-MATRIX.md
- [ ] test -f .planning/specs/surfaces/REST-API-CONTRACTS.md
- [ ] test "$(rg -n '^\\| (GET|POST|PUT|PATCH|DELETE) \\|' .planning/specs/surfaces/REST-API-ENDPOINT-MATRIX.md | wc -l | tr -d ' ')" = "68"
- [ ] rg -n "Acceptance Checks|68/68|Status Codes|Error Behavior" .planning/specs/surfaces/REST-API-CONTRACTS.md
- [ ] git diff --name-only | rg -v '^\.planning/' returns no output
</verification>

<success_criteria>

- All tasks completed
- REST/API endpoint inventory is complete and canonical
- Contracts capture payload shapes, status codes, and error behavior for all routes
- No source implementation files modified

</success_criteria>

<output>
After completion, create `.planning/phases/05-surface-contracts-api-and-websocket/05-01-SUMMARY.md`
</output>
