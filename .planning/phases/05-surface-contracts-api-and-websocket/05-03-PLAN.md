---
phase: 05-surface-contracts-api-and-websocket
plan: 03
type: execute
wave: 2
depends_on: ["05-01", "05-02"]
files_modified:
  - .planning/specs/surfaces/SURFACE-TRACEABILITY.md
  - .planning/specs/surfaces/SURFACE-ACCEPTANCE-CHECKS.md
  - .planning/specs/INDEX.md
autonomous: true
requirements: ["SURF-01", "SURF-02"]
user_setup: []
must_haves:
  truths:
    - "Every REST endpoint and websocket protocol contract is linked to implementing file contracts and verification checks."
    - "Surface-contract artifacts are discoverable as required prerequisites for Phase 6/7 downstream mapping and validation."
  artifacts:
    - ".planning/specs/surfaces/SURFACE-TRACEABILITY.md"
    - ".planning/specs/surfaces/SURFACE-ACCEPTANCE-CHECKS.md"
    - ".planning/specs/INDEX.md"
  key_links:
    - "SURFACE-TRACEABILITY.md links REST/API and websocket contract entries to Phase 4 file-contract artifacts (`ART-####`)."
---

<objective>
Link protocol contracts to file specs and executable checks.

Purpose: Close Phase 5 by binding surface contracts to implementation artifacts and objective acceptance gates.
Output: Surface traceability map, acceptance-check matrix, and index handoff links.
</objective>

<execution_context>
@/Users/peterryszkiewicz/.claude/get-shit-done/workflows/execute-plan.md
@/Users/peterryszkiewicz/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/REQUIREMENTS.md
@.planning/specs/INDEX.md
@.planning/specs/surfaces/REST-API-ENDPOINT-MATRIX.md
@.planning/specs/surfaces/REST-API-CONTRACTS.md
@.planning/specs/surfaces/WEBSOCKET-ENDPOINT-MATRIX.md
@.planning/specs/surfaces/WEBSOCKET-CONTRACTS.md
@.planning/specs/contracts/FILE-CONTRACT-COVERAGE.md
@.planning/specs/contracts/backend-runtime/
@.planning/specs/contracts/frontend-ui/
@.planning/phases/05-surface-contracts-api-and-websocket/05-RESEARCH.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Build surface-to-file traceability map</name>
  <files>.planning/specs/surfaces/SURFACE-TRACEABILITY.md</files>
  <action>Create traceability doc mapping each REST domain and websocket protocol family to implementing backend file contracts (`ART-0102`..`ART-0115`, `ART-0131`) and primary frontend consumer contracts (`ART-0225`, `ART-0226`, `ART-0229`). Include explicit links to endpoint and websocket matrices.</action>
  <verify>rg -n \"REST-API-ENDPOINT-MATRIX|WEBSOCKET-ENDPOINT-MATRIX|ART-0102|ART-0115|ART-0131|ART-0225|ART-0226|ART-0229\" .planning/specs/surfaces/SURFACE-TRACEABILITY.md</verify>
  <done>Surface traceability map exists with explicit protocol-to-artifact linkage coverage.</done>
</task>

<task type="auto">
  <name>Task 2: Publish surface acceptance-check matrix</name>
  <files>.planning/specs/surfaces/SURFACE-ACCEPTANCE-CHECKS.md</files>
  <action>Create acceptance-check matrix that ties SURF-01 and SURF-02 to objective checks (endpoint counts, message-type coverage, schema references, status/error coverage, ordering/failure semantics, and parity checks against frontend consumers).</action>
  <verify>rg -n \"SURF-01|SURF-02|endpoint count|68|websocket|5|status/error|ordering|failure|parity|pass/fail\" .planning/specs/surfaces/SURFACE-ACCEPTANCE-CHECKS.md</verify>
  <done>Acceptance-check matrix exists with executable and requirement-linked criteria.</done>
</task>

<task type="auto">
  <name>Task 3: Publish Phase 5 surface-contract handoff links</name>
  <files>.planning/specs/INDEX.md</files>
  <action>Update `INDEX.md` with Surface Contract Corpus section linking REST/API and WebSocket contract artifacts plus traceability/acceptance-check docs. Mark these as required prerequisites for Phase 6 data/process/security contract work.</action>
  <verify>rg -n \"Surface Contract Corpus|REST-API-CONTRACTS|WEBSOCKET-CONTRACTS|SURFACE-TRACEABILITY|SURFACE-ACCEPTANCE-CHECKS|required prerequisites|Phase 6\" .planning/specs/INDEX.md</verify>
  <done>Index exposes complete Phase 5 surface artifacts and downstream prerequisite linkage.</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] test -f .planning/specs/surfaces/SURFACE-TRACEABILITY.md
- [ ] test -f .planning/specs/surfaces/SURFACE-ACCEPTANCE-CHECKS.md
- [ ] rg -n "ART-0102|ART-0131|ART-0225|ART-0226|ART-0229" .planning/specs/surfaces/SURFACE-TRACEABILITY.md
- [ ] rg -n "SURF-01|SURF-02|68|5|pass/fail" .planning/specs/surfaces/SURFACE-ACCEPTANCE-CHECKS.md
- [ ] rg -n "Surface Contract Corpus" .planning/specs/INDEX.md
- [ ] git diff --name-only | rg -v '^\.planning/' returns no output
</verification>

<success_criteria>

- All tasks completed
- Surface contracts are linked to implementation artifacts and acceptance checks
- Index exposes Phase 5 surface corpus as canonical prerequisite set for next phase
- No source implementation files modified

</success_criteria>

<output>
After completion, create `.planning/phases/05-surface-contracts-api-and-websocket/05-03-SUMMARY.md`
</output>
