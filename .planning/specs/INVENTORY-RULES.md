# Canonical Inventory Rules

**Status:** Active  
**Phase:** 01 (Scope Policy, Inventory, and Guardrails)  
**Last updated:** 2026-02-24

## Discovery

Use this deterministic file-discovery command:

```bash
find . -type f \
  -not -path './.git/*' \
  -not -path './venv/*' \
  -not -path './ui/node_modules/*' \
  -not -path './ui/dist/*' \
  -not -path './__pycache__/*' \
  -not -path './*/__pycache__/*' \
  -not -name '*.pyc' \
  -not -name '*.log' \
  -not -name 'package-lock.json' \
  -not -name 'yarn.lock' \
  -not -name 'pnpm-lock.yaml' \
  -not -name 'bun.lockb' \
  -not -name '*.tsbuildinfo' \
  | sed 's#^\./##' | LC_ALL=C sort
```

Sorting is mandatory (`LC_ALL=C sort`) to ensure stable ID assignment.

## Inclusion

Include authored source-of-truth artifacts required to regenerate behavior and operations, including:
- backend/runtime source
- frontend source and frontend configuration
- tests
- documentation
- scripts and CI/workflow artifacts
- planning/spec corpus markdown and metadata under `.planning/`

## Exclusion

Exclude generated/runtime/transient classes:
- dependency installs and build outputs (`venv/`, `ui/node_modules/`, `ui/dist/`)
- caches and compiled artifacts (`__pycache__/`, `*.pyc`, `*.tsbuildinfo`)
- runtime/debug logs (`*.log`)
- lock files generated by package managers (`package-lock.json`, `yarn.lock`, `pnpm-lock.yaml`, `bun.lockb`)
- tool internals (`.git/`)

Canonical exclusion rationale is maintained in `.planning/specs/EXCLUSIONS.md` (canonical exclusion authority).

## Classification

Each discovered path is tagged with one category by first-match precedence:

1. `PLANNING_DOC` for `.planning/**`
2. `CI_AUTOMATION` for `.github/**`
3. `OPS_AUTOMATION` for `.claude/**`
4. `TEST` for `ui/e2e/**` and `test_*.py`
5. `FRONTEND_SOURCE` for `ui/src/**`, `ui/public/**`, `ui/index.html`
6. `FRONTEND_CONFIG` for remaining `ui/**`
7. `BACKEND_SOURCE` for `api/**`, `server/**`, `mcp_server/**`, and remaining `*.py`
8. `OPERATIONS_SCRIPT` for `bin/**`, `start*.{py,sh,bat}`
9. `DOCUMENTATION` for markdown/text project docs
10. `CONFIG_OR_MISC` fallback

## ID

ID assignment is deterministic and sequential:
- format: `ART-####`
- starting value: `ART-0001`
- order basis: sorted discovery list
- stability rule: IDs remain stable for unchanged relative order; additions receive new IDs according to sorted position

## Reproducibility Procedure

1. Run discovery command.
2. Apply classification rules.
3. Assign sequential IDs by sorted order.
4. Regenerate `.planning/specs/INVENTORY.md`.
5. Confirm only `.planning/**` files changed.

## Exclusion Governance

Governance rule: exclusion rationale and pattern changes must be updated in both `INVENTORY-RULES.md` and `EXCLUSIONS.md` in the same plan to prevent silent drift.
